This solution uses a DFS.